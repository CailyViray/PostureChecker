<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Posture Checker</title>
<style>
    body {
        margin: 0;
        font-family: "Space Mono", monospace;
        background: radial-gradient(circle at top, #00001a, #1a0026);
        color: white;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    .starfield {
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        pointer-events: none;
        background: transparent;
        z-index: -1;
    }
    @keyframes comet {
        0% { transform: translate(-10%, -10%) scale(0.2); opacity: 0; }
        10% { opacity: 1; }
        100% { transform: translate(120%, 120%) scale(1.5); opacity: 0; }
    }
    .comet {
        position: absolute;
        width: 4px; height: 4px;
        background: white;
        border-radius: 50%;
        box-shadow: 0 0 8px 4px teal;
        animation: comet 5s linear;
    }
    h1 {
        text-align: center;
        font-size: 2.5em;
        margin: 40px 0;
        letter-spacing: 4px;
        text-shadow: 0 0 12px rgba(255,255,255,0.8);
    }
    h2 {
        font-size: 1.4em;
        margin-bottom: 10px;
        color: #9cd6ff;
        text-shadow: 0 0 12px rgba(100, 180, 255, 0.9), 0 0 20px rgba(100, 180, 255, 0.7);
    }
    .panel-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        width: 90%;
        max-width: 1200px;
        gap: 20px;
    }
    .panel {
        background: rgba(0, 0, 0, 0.45);
        backdrop-filter: blur(12px);
        width: 300px;
        min-height: 250px;
        padding: 20px;
        border-radius: 20px;
        border: 2px solid rgba(255,255,255,0.2);
        box-shadow: 0 0 25px rgba(0, 200, 255, 0.25);
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        justify-content: flex-start;
    }
    button {
        background: transparent;
        border: 2px solid teal;
        padding: 10px 25px;
        font-size: 1.1em;
        color: white;
        border-radius: 12px;
        margin-top: 10px;
        cursor: pointer;
        transition: 0.3s;
        box-shadow: 0 0 12px teal;
        align-self: center;
    }
    button:hover {
        background: teal;
        box-shadow: 0 0 18px red;
    }
    #label-container div {
        margin-top: 8px;
        padding: 6px;
        border-radius: 10px;
        font-size: 1.05em;
    }
    .good { border-left: 6px solid #00ff9d; }
    .bad { border-left: 6px solid #ff4343; }
    .neutral { border-left: 6px solid #ffe066; }
    .indicator {
        width: 12px; height: 12px;
        border-radius: 50%;
        display: inline-block;
        margin-right: 8px;
    }
    .indicator.good { background: #00ff9d; }
    .indicator.bad { background: #ff4343; }
    .indicator.neutral { background: #ffe066; }
    h2, p { color: #e8d7ff; text-shadow: 0 0 8px rgba(255,255,255,0.6); }
</style>
</head>
<body>

<div class="starfield" id="starfield"></div>
<h1>Posture Checker</h1>

<div class="panel-container">
    <div class="panel">
        <h2>How to Use</h2>
        <p>1. Click the Start button.<br>2. Allow webcam access.<br>3. Sit so your upper body is visible.<br>4. The AI will classify your posture in real time.</p>
    </div>

    <div class="panel">
        <h2>What This Project Does</h2>
        <p>This AI posture checker uses a Teachable Machine pose model to help users improve posture anywhere—at school, home, or in bed. It identifies three posture classes: Good, Bad, and Neutral/Undetected.</p>
    </div>

    <div class="panel">
        <h2>The Problem</h2>
        <p>Many students and computer users spend long periods working on devices, leading to slouching, neck strain, and back discomfort. Poor posture affects focus, comfort, and long-term health, but most people don’t notice when they begin to slouch.</p>
    </div>

    <div class="panel">
        <h2>Who Benefits</h2>
        <p>This tool helps anyone who uses a computer or mobile device extensively. Specifically:<br>• Students and teachers using Chromebooks<br>• Office workers or remote workers<br>• Gamers and streamers<br>• Artists or programmers<br>• People recovering from minor back or neck issues<br>• Anyone wanting instant posture feedback and better habits</p>
    </div>

    <div class="panel">
        <h2>Start</h2>
        <button type="button" onclick="init()">Start</button>
        <div id="webcam-container"></div>
        <div id="label-container"></div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>
<script>
function spawnComet() {
    const comet = document.createElement("div");
    comet.classList.add("comet");
    comet.style.top = Math.random() * window.innerHeight + "px";
    comet.style.left = Math.random() * window.innerWidth + "px";
    document.getElementById("starfield").appendChild(comet);
    setTimeout(() => comet.remove(), 5000);
}
setInterval(spawnComet, 25000);

const URL = "./my_model/";
let model, webcam, labelContainer, maxPredictions;

async function init() {
    const modelURL = URL + "model.json";
    const metadataURL = URL + "metadata.json";

    model = await tmImage.load(modelURL, metadataURL);
    maxPredictions = model.getTotalClasses();

    const flip = true;
    webcam = new tmImage.Webcam(200, 200, flip);
    await webcam.setup();
    await webcam.play();
    window.requestAnimationFrame(loop);

    document.getElementById("webcam-container").appendChild(webcam.canvas);
    labelContainer = document.getElementById("label-container");
    for (let i = 0; i < maxPredictions; i++) {
        const div = document.createElement("div");
        labelContainer.appendChild(div);
    }
}

async function loop() {
    webcam.update();
    await predict();
    window.requestAnimationFrame(loop);
}

async function predict() {
    const prediction = await model.predict(webcam.canvas);

    for (let i = 0; i < prediction.length; i++) {
        const className = prediction[i].className;
        const prob = prediction[i].probability.toFixed(2);
        let statusClass = "neutral";
        if (className.toLowerCase().includes("good")) statusClass = "good";
        if (className.toLowerCase().includes("bad")) statusClass = "bad";

        labelContainer.childNodes[i].innerHTML = `<span class="indicator ${statusClass}"></span>${className}: ${prob}`;
        labelContainer.childNodes[i].className = statusClass;
    }
}
</script>
</body>
</html>
